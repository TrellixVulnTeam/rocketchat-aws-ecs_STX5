{"version":3,"sources":["meteor://ðŸ’»app/packages/rocketchat:ui-admin/publications/adminRooms.js"],"names":["_","module","watch","require","default","v","s","Meteor","publish","filter","types","limit","userId","ready","RocketChat","authz","hasPermission","isArray","options","fields","name","t","cl","u","usernames","muted","ro","topic","msgs","archived","tokenpass","sort","trim","length","models","Rooms","findByNameContainingAndTypes","findByTypes","findByNameContaining"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AAAA,IAAIA,CAAJ;;AAAMC,OAAOC,KAAP,CAAaC,QAAQ,YAAR,CAAb,EAAmC;AAACC,SAAQC,CAAR,EAAU;AAACL,MAAEK,CAAF;AAAI;;AAAhB,CAAnC,EAAqD,CAArD;AAAwD,IAAIC,CAAJ;AAAML,OAAOC,KAAP,CAAaC,QAAQ,mBAAR,CAAb,EAA0C;AAACC,SAAQC,CAAR,EAAU;AAACC,MAAED,CAAF;AAAI;;AAAhB,CAA1C,EAA4D,CAA5D;AAGpEE,OAAOC,OAAP,CAAe,YAAf,EAA6B,UAASC,MAAT,EAAiBC,KAAjB,EAAwBC,KAAxB,EAA+B;AAC3D,KAAI,CAAC,KAAKC,MAAV,EAAkB;AACjB,SAAO,KAAKC,KAAL,EAAP;AACA;;AACD,KAAIC,WAAWC,KAAX,CAAiBC,aAAjB,CAA+B,KAAKJ,MAApC,EAA4C,0BAA5C,MAA4E,IAAhF,EAAsF;AACrF,SAAO,KAAKC,KAAL,EAAP;AACA;;AACD,KAAI,CAACb,EAAEiB,OAAF,CAAUP,KAAV,CAAL,EAAuB;AACtBA,UAAQ,EAAR;AACA;;AAED,OAAMQ,UAAU;AACfC,UAAQ;AACPC,SAAM,CADC;AAEPC,MAAG,CAFI;AAGPC,OAAI,CAHG;AAIPC,MAAG,CAJI;AAKPC,cAAW,CALJ;AAMPC,UAAO,CANA;AAOPC,OAAI,CAPG;AAQPtB,YAAS,CARF;AASPuB,UAAO,CATA;AAUPC,SAAM,CAVC;AAWPC,aAAU,CAXH;AAYPC,cAAW;AAZJ,GADO;AAefnB,OAfe;AAgBfoB,QAAM;AACL3B,YAAS,CAAC,CADL;AAELgB,SAAM;AAFD;AAhBS,EAAhB;AAsBAX,UAASH,EAAE0B,IAAF,CAAOvB,MAAP,CAAT;;AACA,KAAIA,UAAUC,MAAMuB,MAApB,EAA4B;AAC3B;AACA,SAAOnB,WAAWoB,MAAX,CAAkBC,KAAlB,CAAwBC,4BAAxB,CAAqD3B,MAArD,EAA6DC,KAA7D,EAAoEQ,OAApE,CAAP;AACA,EAHD,MAGO,IAAIR,MAAMuB,MAAV,EAAkB;AACxB;AACA,SAAOnB,WAAWoB,MAAX,CAAkBC,KAAlB,CAAwBE,WAAxB,CAAoC3B,KAApC,EAA2CQ,OAA3C,CAAP;AACA,EAHM,MAGA;AACN;AACA,SAAOJ,WAAWoB,MAAX,CAAkBC,KAAlB,CAAwBG,oBAAxB,CAA6C7B,MAA7C,EAAqDS,OAArD,CAAP;AACA;AACD,CA5CD,E","file":"/packages/rocketchat_ui-admin.js","sourcesContent":["import _ from 'underscore';\nimport s from 'underscore.string';\n\nMeteor.publish('adminRooms', function(filter, types, limit) {\n\tif (!this.userId) {\n\t\treturn this.ready();\n\t}\n\tif (RocketChat.authz.hasPermission(this.userId, 'view-room-administration') !== true) {\n\t\treturn this.ready();\n\t}\n\tif (!_.isArray(types)) {\n\t\ttypes = [];\n\t}\n\n\tconst options = {\n\t\tfields: {\n\t\t\tname: 1,\n\t\t\tt: 1,\n\t\t\tcl: 1,\n\t\t\tu: 1,\n\t\t\tusernames: 1,\n\t\t\tmuted: 1,\n\t\t\tro: 1,\n\t\t\tdefault: 1,\n\t\t\ttopic: 1,\n\t\t\tmsgs: 1,\n\t\t\tarchived: 1,\n\t\t\ttokenpass: 1\n\t\t},\n\t\tlimit,\n\t\tsort: {\n\t\t\tdefault: -1,\n\t\t\tname: 1\n\t\t}\n\t};\n\n\tfilter = s.trim(filter);\n\tif (filter && types.length) {\n\t\t// CACHE: can we stop using publications here?\n\t\treturn RocketChat.models.Rooms.findByNameContainingAndTypes(filter, types, options);\n\t} else if (types.length) {\n\t\t// CACHE: can we stop using publications here?\n\t\treturn RocketChat.models.Rooms.findByTypes(types, options);\n\t} else {\n\t\t// CACHE: can we stop using publications here?\n\t\treturn RocketChat.models.Rooms.findByNameContaining(filter, options);\n\t}\n});\n"]}